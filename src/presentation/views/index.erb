<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />
    <title>Polling Is For Chumps</title>
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:regular,semibold,italic,italicsemibold|PT+Sans:400,700,400italic,700italic|PT+Serif:400,700,400italic,700italic" rel="stylesheet" />
    <link href="styles/main.css" rel="stylesheet" /> </head>
    <link href="styles/highlight.css" rel="stylesheet" />
  <body>
    <div id="impress">
      <div id="title" class="step slide" data-x="0" data-y="0" data-scale="3">
        <div class="big bold">
          <div id="title-polling">Polling</div>
          <div id="title-chumps">Is For Chumps</div>
        </div>
      </div>


      <div id="live-data" class="step slide" data-x="1800" data-y="0">
        <div class="big bold" id="live-data-title">Live Data</div>
        <div class="light">
          <div id="live-data-text1">Social Networking</div>
          <div id="live-data-text2">Stocks</div>
          <div id="live-data-text3">Server Monitoring</div>
          <div id="live-data-text4">Games</div>
        </div>
      </div>

      <div id="ajax-title" class="step section-start" data-x="-800" data-y="700">
        <div class="big bold header">AJAX</div>
        <div>Asynchronus Javascript and XML</div>
      </div>

      <div id="ajax-setinterval" class="step" data-x="-1000" data-y="1000" data-scale="0.3">
        <img src="images/phone.jpg" />
        <q class="big bold subtitle">Hello?</q>
      </div>

      <div id="ajax-process" class="step" data-x="-1000" data-y="1180" data-scale="0.3">
        <div>Wait An Interval</div>
        <div>Call Service</div>
        <div>Receive Response</div>
        <div>Hang Up</div>
        <div>Repeat</div>
      </div>

      <div id="ajax-code" class="step" data-x="-1000" data-y="1310" data-scale="0.3">
        <pre>
        <code>
var timeout = 5000;
setInterval(function(){
  $.getJSON('home.json', function(data) {
      //Update View
  });
}, timeout);
        </code>
        </pre>
      </div>

      <div id="ajax-simple" class="step header bold" data-x="-1000" data-y="1400" data-scale="0.3">Simple</div>
      <div id="ajax-complex" class="step" data-x="-1000" data-y="1700" data-scale="1">
        <div class="bold subtitle">Complexity Grows</div>
        <div>Multiple Data Points</div>
        <div>Partial Data Sets</div>
        <div>Self Built DoS Attack</div>
      </div>


      <div id="serversent-title" class="step section-start" data-x="0" data-y="700">
        <div class="big bold header">SSE</div>
        <div>Server-Sent Events</div>
      </div>

      <div id="serversent-photo" class="step" data-x="-280" data-y="1000" data-scale="0.3">
        <img src="images/radio.jpg" />
        <q class="big bold subtitle">The Listener</q>
      </div>

      <div id="serversent-vanilla" class="step big bold header" data-x="-280" data-y="1180" data-scale="0.3">
        Vanilla HTTP
      </div>

      <div id="serversent-request" class="step" data-x="-280" data-y="1290" data-scale="0.2">
        <pre>
        <code>GET /stocks HTTP/1.1
Connection: keep-alive
Accept: text/event-stream</code>
        </pre>
      </div>

      <div id="serversent-response" class="step" data-x="-280" data-y="1390" data-scale="0.2">
        <pre>
        <code>HTTP/1.1 200 OK
Content-Type: text/event-stream

name: AAPL
data: 507.03

data: Sell!

name: GOOG
data: 27.13

...

data: Buy!</code>
        </pre>
      </div>

      <div id="serversent-server" class="step" data-x="-280" data-y="1550" data-scale="0.2">
        <pre>
        <code>@@streams = []
@@price = 500.0

get '/stocks', provides: 'text/event-stream' do
  stream :keep_open do |out|
    @@streams.push(out)
    out.callback { @@streams.delete(out) }
  end
end

def notify(data, name=nil)
  @@streams.each do |out|
    out << "event: #{name}\n" if name
    out << "data: #{data}\n\n"
  end
end

Thread.new do
  while true
    sleep rand(2)
    notify((@@price += rand(3)), 'AAPL')
    notify(rand(2) == 1 ? 'Buy!' : 'Sell!')
  end
end </code>
        </pre>
      </div>

      <div id="serversent-subscribe" class="step big bold header" data-x="-280" data-y="1650" data-scale="0.3">
        Subscribe
      </div>

      <div id="serversent-client" class="step" data-x="-280" data-y="1740" data-scale="0.2">
        <pre>
        <code>var es = new EventSource('/stocks');

//Named Events
es.addEventListener('AAPL', function(e) {
  $('#aapl-price').innerText = e.data;
});

//Unnamed Events
es.onmessage = function(e) {
  $('#notify').innerText = e.data;
};</code>
        </pre>
      </div>

      <div id="serversent-perks" class="step big bold header" data-x="-280" data-y="1830" data-scale="0.3">
        Perks
      </div>

      <div id="serversent-immediate" class="step" data-x="-280" data-y="1890" data-scale="0.2">
        <div class="big bold subtitle">Immediate</div>
      </div>

      <div id="serversent-persistent" class="step" data-x="-280" data-y="1950" data-scale="0.2">
        <div class="big bold subtitle">Persistent</div>
        <img src="images/sse-persist.png" />
      </div>

      <div id="serversent-compatible" class="step" data-x="-280" data-y="2030" data-scale="0.2">
        <div class="big bold subtitle">Compatible</div>
        <img src="images/compatible.png" />
      </div>

      <div id="serversent-quirks" class="step big bold header" data-x="-280" data-y="1830" data-scale="0.3">
        Pains
      </div>

      <div id="serversent-polyfill" class="step" data-x="-240" data-y="2050" data-z="-2000" data-scale="0.02">
        <div class="big bold subtitle">Javascript Polyfill</div>
        <img src="images/incompatible.png" />
        <a href="https://github.com/Yaffle/EventSource">Yaffle/EventSource</a>
        <a href="https://github.com/remy/polyfills/blob/master/EventSource.js">remy/pollyfills</a>
        </ul>
      </div>



      <div id="websockets-title" class="step section-start" data-x="800" data-y="700">
        <div class="big bold header">WS</div>
        <div>WebSockets</div>
      </div>

      <div id="setinterval" class="step" data-x="2000" data-y="0" data-scale="1">
        <div class="big bold">
        </div>
      </div>
    </div>

    <script src="lib/highlight.pack.js"></script>
    <script src="lib/impress.js"></script>
    <script>
      hljs.initHighlightingOnLoad();
      window.api = impress();
    </script>
    <% if master %>
      <script src="lib/zepto.min.js"></script>
      <script src="lib/master.js"></script>
    <% else %>
      <script src="lib/viewer.js"></script>
    <% end %>

  </body>
</html>
